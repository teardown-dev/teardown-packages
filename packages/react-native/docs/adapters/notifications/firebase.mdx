---
title: FirebaseMessagingAdapter
description: Notification adapter for Firebase Cloud Messaging.
---

The `FirebaseMessagingAdapter` integrates with Firebase Cloud Messaging for push notifications.

## Installation

```bash
npm install @react-native-firebase/app @react-native-firebase/messaging
# or
bun add @react-native-firebase/app @react-native-firebase/messaging
```

For iOS:
```bash
cd ios && pod install
```

## Usage

```typescript
import { TeardownCore } from '@teardown/react-native';
import { FirebaseMessagingAdapter } from '@teardown/react-native/firebase';
import { DeviceInfoAdapter } from '@teardown/react-native/adapters/device-info';
import { AsyncStorageAdapter } from '@teardown/react-native/adapters/async-storage';

const teardown = new TeardownCore({
  org_id: 'your-org-id',
  project_id: 'your-project-id',
  api_key: 'your-api-key',
  storageAdapter: new AsyncStorageAdapter(),
  deviceAdapter: new DeviceInfoAdapter(),
  notificationAdapter: new FirebaseMessagingAdapter(),
});

// Access via NotificationsClient
if (teardown.notifications) {
  const status = await teardown.notifications.requestPermissions();
  if (status.granted) {
    const token = await teardown.notifications.getToken();
    console.log('FCM token:', token);
  }
}
```

## Import Path

```typescript
import { FirebaseMessagingAdapter } from '@teardown/react-native/firebase';
```

## API

All methods are accessed via `NotificationsClient`, not directly on the adapter.

### requestPermissions()

Request notification permissions (required on iOS):

```typescript
const status = await teardown.notifications.requestPermissions();
// Returns: { granted: boolean, canAskAgain: boolean }
```

### getToken()

Get the FCM registration token:

```typescript
const token = await teardown.notifications.getToken();
// Returns: FCM token string or null
```

### onNotificationReceived()

Subscribe to foreground notifications:

```typescript
const unsubscribe = teardown.notifications.onNotificationReceived((notification) => {
  console.log('Received:', notification.title);
});

// Cleanup
unsubscribe();
```

### onNotificationOpened()

Subscribe to notification taps:

```typescript
const unsubscribe = teardown.notifications.onNotificationOpened((notification) => {
  console.log('User tapped:', notification.title);
});

// Cleanup
unsubscribe();
```

### onTokenRefresh()

Subscribe to token changes:

```typescript
const unsubscribe = teardown.notifications.onTokenChange((token) => {
  console.log('New FCM token:', token);
});

// Cleanup
unsubscribe();
```

### onDataMessage()

Subscribe to data-only messages (silent push):

```typescript
const unsubscribe = teardown.notifications.onDataMessage((message) => {
  console.log('Data message:', message.data);
});

// Cleanup
unsubscribe();
```

## Configuration

### Android

1. Add `google-services.json` to `android/app/`
2. Add to `android/build.gradle`:

```groovy
buildscript {
  dependencies {
    classpath 'com.google.gms:google-services:4.3.15'
  }
}
```

3. Add to `android/app/build.gradle`:

```groovy
apply plugin: 'com.google.gms.google-services'
```

### iOS

1. Add `GoogleService-Info.plist` to iOS project
2. Enable Push Notifications capability in Xcode
3. Upload APNs key to Firebase Console

## Background Messages

Handle messages when app is in background:

```typescript
import messaging from '@react-native-firebase/messaging';

// Register background handler (must be outside component)
messaging().setBackgroundMessageHandler(async (remoteMessage) => {
  console.log('Background message:', remoteMessage);
});
```

## Platform

Returns `NotificationPlatformEnum.FCM`

## Requirements

- `@react-native-firebase/app` >= 18.0.0
- `@react-native-firebase/messaging` >= 18.0.0
- React Native >= 0.71
